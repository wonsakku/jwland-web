<!DOCTYPE html>
<!-- <html lang="en" -->
<!--       xmlns:th="http://www.thymeleaf.org" -->
<!--       xmlns:sec="http://www.thymeleaf.org/extras/spring-security"> -->
<html xmlns:th="http://www.thymeleaf.org" xmlns:sd="http://www.thymeleaf.org/spring-data" layout:decorator="layout/layout.html" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
<title></title>
</head>
<body>

<main layout:fragment="content">
	<div class="container">
      <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
          <h1 class="h2">모의고사 체크</h1>
          <div class="btn-toolbar mb-2 mb-md-0">
            	<!-- Button trigger modal -->
				<button type="button" class="btn btn-info btn-sm mr-1" data-toggle="modal" data-target="#popup-enroll-exam">
				  기출 등록
				</button>
				<button type="button" class="btn btn-warning btn-sm mr-1" data-toggle="modal" data-target="#popup-update-exam" id="popup-update-exam-btn">
				  기출 수정
				</button>
				<button type="button" class="btn btn-primary btn-sm mr-1" data-toggle="modal" data-target="#popupEnroll">
				  오답 등록
				</button>
				<button type="button" class="btn btn-success btn-sm mr-1" data-toggle="modal" data-target="#popupUpdate">
				  오답 수정
				</button>
				<button type="button" class="btn btn-secondary btn-sm mr-1" data-toggle="modal" data-target="#popupUpdate">
				  내가 틀린 문제
				</button>
          </div>
        </div>

		<table class="table text-center">
		  <thead class="thead-dark">
		    <tr>
		      <th scope="col">순번</th>
		      <th scope="col">연도</th>
		      <th scope="col">월</th>
		      <th scope="col">시험명</th>
		      <th scope="col">과목</th>
		      <th scope="col">번호</th>
		      <th scope="col">오답자수</th>
		    </tr>
		  </thead>
		  <tbody id="exam-table-body">
		  </tbody>
		</table>
	</div>
	
	<div th:replace="layout/exam-enroll-fragment.html :: popup-enroll-exam"></div>
	<div th:replace="layout/exam-update-fragment.html :: popup-update-exam"></div>
	





	<!-- Modal -->
	<div class="modal fade" id="selectProblemNumber" data-backdrop="static" data-keyboard="false" tabindex="-2" aria-labelledby="staticBackdropLabel3" aria-hidden="true">
	  <div class="modal-dialog  modal-dialog-scrollable">
	    <div class="modal-content">
	      <div class="modal-header">
	        <h5 class="modal-title" id="staticBackdropLabel3">번호 선택</h5>
	        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
	          <span aria-hidden="true">&times;</span>
	        </button>
	      </div>
	       
	      <div class="modal-body">
	      	<ul class="list-group font-weight-bold" id="problem-number-list">
	      	  <th:block th:each="m : ${#numbers.sequence(1,20)}">
	      	  <li class="list-group-item">
	      	  	<input type="checkbox" th:name="|problem-number-${m}|" th:id="|problem-number-${m}|" 
	      	  	class="mr-2" aria-label="Checkbox for following text input" th:value="${m}">
	      	  	<label th:for="|problem-number-${m}|" th:text="${m}" style="width:90%; height: 100%;"></label>
	      	  </li>
	      	  </th:block>
			</ul>
	      </div>
	      <div class="modal-footer">
	        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
	        <button type="button" class="btn btn-primary">Understood</button>
	      </div>
	    </div>
	  </div>
	</div>
	

</main>
</body>
</html>

<script th:replace="layout/exam-enroll-fragment.html :: popup-enroll-exam-event"></script>
<script th:replace="layout/exam-update-fragment.html :: popup-update-exam-event"></script>
<script th:inline="javascript">
// <script type="application/javascript">
// 	console.log(data);	
// 	console.log(2);
	(function(){
		showExamList();
	})();
	
	function showExamList(){
		var url = "/exam-check";
	    $.ajax({
	        url: url,
	        method: "GET",
	        success: function(data, xhr, status){
	          _cb_showEaxmList(data, xhr, status);
	        },
	        fail: function(xhr, xhrStatus, err){
	          alert(JSON.stringify(xhr));
	        }
        });
	}
	
	
	function _cb_showEaxmList(data){
		console.log(data);
		
		$("#exam-table-body").html("");
		var html = "";
		
		for(var i = 0 ; i < data.length ; i++){
			html += "<tr>";
			html += "<th scope='row'>" + (i+1) + "</th>";
			html += "<td>" + data[i].year + "년</td>";
			html += "<td>" + data[i].month + "월</td>";
			html += "<td>" + data[i].examType + "</td>";
			html += "<td>" + data[i].subject + "</td>";
			html += "<td>" + data[i].problemNumber + "번</td>";
			html += "<td>" + data[i].wrongCount + "명</td>";
			html += "</tr>";
		}
		
		$("#exam-table-body").html(html);
		
	}
	
	
</script>























