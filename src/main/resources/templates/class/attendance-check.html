<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sd="http://www.thymeleaf.org/spring-data"
	layout:decorator="layout/layout.html"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
<title></title>
    <style>
      .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
      }

      @media (min-width: 768px) {
        .bd-placeholder-img-lg {
          font-size: 3.5rem;
        }
      }
    </style>

</head>
<body>
	<main layout:fragment="content"  role="main">
			
	  <div class="album py-5 bg-light">
	  	  <div class="row pb-4">
		      <h3 class="col-md-6 col-sm-12">[ [[${className}]] ] 출결관리</h3>
		      <div class="col-md-6 col-sm-12 text-right">
		      	<select>
		      		<option>==출석 확인==</option>
		      		<option>2021-11-13</option>
		      		<option>2021-11-14</option>
		      		<option>2021-11-20</option>
		      		<option>2021-11-21</option>
		      	</select>
		      </div>
	  	  </div>
	      <div class="table-responsive text-center">
	        <table class="table table-striped table-sm">
	          <thead>
	            <tr>
	              <th></th>
	              <th>이름</th>
	              <th>닉네임</th>
	              <th>출석</th>
	            </tr>
	          </thead>
	          <tbody id="attendance-table-body">
	          </tbody>
	        </table>
	      </div>
	  </div>
	</main>
</body>

</html>




<script th:inline="javascript">
	
	var accountSequenceList = new Array();
	const classSequenceNo = [[${classSequenceNo}]];

	(function() {
		loadEnrolledStudents();
	})();
	
	
	function loadEnrolledStudents() {
		
		var url = "/class/classes/" + classSequenceNo + "/account-infos";
		
		$.ajax({
			url: url,
			type: "GET",
			timeout: 10000,
			success: function(data, xhrStatus, xhr){
				_cb_loadEnrolledStudents(data, xhrStatus, xhr);
			},
			error: function(a, b, c){
				alert("학생 데이터를 로딩하는 중 문제가 발생했습니다.");
			}
		});
	}
	
	function _cb_loadEnrolledStudents(data, xhrStatus, xhr){
		
		var $attendanceTableBody = $("#attendance-table-body");
		$attendanceTableBody.html("");

		var html = "";
		
		for(var i = 0 ; i < data.length ; i++){
			html += "<tr>";
			html += "<td><input type='hidden' class='account_sequence_no' value='" + data[i].accountSequenceNo + "'></td>";
			html += "<td>" + data[i].name + "</td>";
			html += "<td>" + data[i].nickName + "</td>";
			html += "<td>";
			html += "<select class='status'>";
			html += "<option disabled selected>출석 여부를 선택해 주세요</option>";
			html += "<option value='출석'>출석</option>";
			html += "<option value='지각'>지각</option>";
			html += "<option value='결석'>결석</option>";
			html += "</select>";
			html += "</td>";
			html += "</tr>";
		}
		
		$attendanceTableBody.html(html);
	}
	
	
	function addStudents(){
		
		if(!confirm("등록하시겠습니까?")){
			return ;
		}
		
		var formData = document.createElement("form");
		
		var hiddenField = document.createElement("input");
		hiddenField.setAttribute("type", "hidden");
		hiddenField.setAttribute("name", "classSequenceNo");
		hiddenField.setAttribute("value", classSequenceNo);
		formData.appendChild(hiddenField);
		
		for(var i = 0 ; i < accountSequenceList.length ; i++){
			var hiddenField2 = document.createElement("input");
			hiddenField2.setAttribute("type", "hidden");
			hiddenField2.setAttribute("name", "accountSequenceList[" + i + "]");
			hiddenField2.setAttribute("value", accountSequenceList[i]);
			formData.appendChild(hiddenField2);
		}
		
		formData.setAttribute("charset", "UTF-8");
		formData.setAttribute("method", "post");
		formData.setAttribute("action", "/class/classes/student/enroll");
		
		document.body.appendChild(formData);
		
		formData.submit();
	}
	
	
</script>













